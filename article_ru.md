# 640Kb хватит всем!

___Эта статья посвящена выпускной работе на курсе Разработчик Python.___

&nbsp;&nbsp;&nbsp;В наши дни, глядя на окружающий нас поток информации, мы можем уверенно заявить, что Оруэлл ошибался, а Хаксли оказался прав. Бесчисленное количество мусора в этом потоке уже сложно отсеивать глазами, да и нужные новости подаются, сервированные тяжёлыми скриптами, формами, всплывающими сообщениями.

&nbsp;&nbsp;&nbsp;За день в мире делается столько фотографии, сколько ещё лет десять-пятнадцать назад люди делали за год. Помножьте это на средний размер в один мегабайт и вы получите ужасающее количество ненужной информации; объем библии - полтора мегабайта. Я не верю, что ваш пост с фотографией утреннего кофе и со всеми комментариями, несёт больше смысла.

&nbsp;&nbsp;&nbsp;Задумайтесь сколько ресурсов необходимо для поддержания такого трафика? Процессорных мощностей, объемов накопителей, электричества. Вы можете возразить, что такое потребление вызывает зеркальный рост технических инноваций - скоростные диски, многоядерные процессоры... Да, я соглашусь с вами, но технических инноваций для чего? В космос мы всё ещё летаем на процессорах частотой в 200Мгц, а это в 10 раз меньше чем в вашем смартфоне. На порядок!

&nbsp;&nbsp;&nbsp;Сколько ведётся разговоров о грамотном использовании ресурсов, о вторичной переработке мусора. Не пора ли обратить на это внимание в IT сфере?

&nbsp;&nbsp;&nbsp;В то же время, такая расхлябанность в потреблении, вызвала расхлябанность в разработке, то на что сейчас мало кто обращает внимание, ибо это подводная часть айсберга. Копните глубже и взгляните на создаваемый программистами код: если раньше в школе били линейкой по пальцам за забытый вызов "free", то сейчас подтянуть какую-нибудь библиотеку ради одной функции - привычное дело. Ругать сборщики мусора - неослабевающий тренд. Вот и имеем на выходе приложение с функциональностью чуть сложнее блокнота и потреблением памяти в 60-70 гигабайт. Рано или поздно, эта проблема выстрелит, но кто будет готов переписать тонны кода в рабочих процессах? Даже сейчас внедрение новых функций в работающую систему без нарушения целостности процесса - это хирургическая операция. Насколько же сложна будет полная замена кода?

&nbsp;&nbsp;&nbsp;Конечно моё приложение не панацея от всех бед, но это призыв обратить внимание на ограниченность ресурсов. Задуматься об их потреблении.
Суть сервиса проста - это социальная сеть с привычными для нас всех функциями: просмотр и добавление новостей, общение с друзьями, операции с лайками.
Но есть одно ограничение: на всё это вам даётся 640 Килобайт, и не только на сам контент, сюда входит и то что не видно глазу. Ведь никто же не задумывается, сколько ресурсов занимает сообщение "Привет" на самом деле? Вроде всего 6 байт, а если это UTF-8? Умножьте это на два. А сколько записей создаётся в базе данных? Как минимум: идентификатор записи и ссылка на владельца сообщения. За "Метрополис" мира IT тоже приходится платить нам с вами.

Приложение имеет очевидные плюсы:
- Заранее известен максимальный объем страницы пользователя, отсюда проще считать ресурсы для обслуживания сервиса. Допустим у нас 3млрд. пользователей. Это 1,92×10¹² Кб данных или 1788Тб. Цифра конечно огромная, в месяц за аренду такого количества места в облаке придётся заплатить цену сопоставимую с ценой квартиры в Москве. Однако это всё равно меньше существующих решений.
- "Нелинейные лайки". Так как в этой системе всё имеет вес, лайки не исключение. Каждый поставленный лайк отнимает несколько байт из вашей копилки. Плюс алгоритм расчёта лайков имеет зависимость от объема страницы пользователя. Чем больше вы занимаете места, тем меньше "вес" вашего лайка.
- Защита от спама. Как ни крути, а разослать сообщений больше 640Кб у пользователя не получится.

Есть и минусы:
- Не получится в красках рассказать о проведённом отпуске. Одна FULLHD фотография требует места в два раза больше чем предоставляется сервисом.
- Не получится добавить миллионы друзей. Придётся ограничиться кругом лиц, которые вам действительно интересны

#### Обращаясь к технической составляющей проекта, то тут всё довольно просто.
На бекенде используется следующее:
- Основой является фреймворк Django в связке с БД Postgresql.
- Channels и Redis используются для обмена сообщений между пользователями. Попросту говоря для чата между ними.
- Так же каждый пользователь имеет свой канал "update flow", через который ему приходят сообщения о новых событиях и изменений размера его страницы.
На фронтенде:
- Bootstrap 4.0 как основной набор стилевых шаблонов
- Vue.js для интерактивного взаимодействия с пользователем.
- Websocket для общения с каналами

На текущий момент не реализованы следующие идеи:
- Хранение объема страницы пользователя в key-value хранилище, для более быстрого доступа. В данный момент при запросе объема страницы происходит полный пересчёт, а это трудозатратная операция.
- ASCII ART. Если уж мы говорим о скромном потреблении, то уместно бы было использовать в качестве картинок старый-добрый ascii-art.
- Вёрстка. Сейчас приложение оптимизировано только под один браузер и только под десктоп. Вёрстка никогда не была моей сильной стороной, но это решаемый вопрос.
